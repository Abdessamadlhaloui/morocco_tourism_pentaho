<?xml version="1.0" ?>
<transformation>
  <info>
    <name>10_voies_acces</name>
    <description>Transformation for loading 10_voies_acces.csv</description>
    <trans_type>Normal</trans_type>
    <directory>/</directory>
  </info>
  <connection>
    <name>morocco_tourism</name>
    <server>localhost</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>morocco_tourism</database>
    <port>5432</port>
    <username>postgres</username>
    <password>your_password_here</password>
  </connection>
  <step>
    <name>Lire_voies_acces</name>
    <type>TextFileInput</type>
    <distribute>Y</distribute>
    <copies>1</copies>
    <GUI>
      <xloc>100</xloc>
      <yloc>100</yloc>
      <draw>Y</draw>
    </GUI>
    <separator>,</separator>
    <enclosure>&quot;</enclosure>
    <header>Y</header>
    <encoding>UTF-8</encoding>
    <file>
      <name>data/raw/10_voies_acces.csv</name>
    </file>
    <fields>
      <field>
        <name>Voie_Acces</name>
        <type>String</type>
      </field>
      <field>
        <name>Point_Entree</name>
        <type>String</type>
      </field>
      <field>
        <name>Total</name>
        <type>String</type>
      </field>
      <field>
        <name>MRE</name>
        <type>String</type>
      </field>
      <field>
        <name>Touristes_Etrangers</name>
        <type>String</type>
      </field>
    </fields>
  </step>
  <step>
    <name>Standardiser_colonnes</name>
    <type>SelectValues</type>
    <distribute>Y</distribute>
    <copies>1</copies>
    <GUI>
      <xloc>350</xloc>
      <yloc>100</yloc>
      <draw>Y</draw>
    </GUI>
    <fields>
      <field>
        <name>Voie_Acces</name>
        <rename>voie_acces</rename>
      </field>
      <field>
        <name>Point_Entree</name>
        <rename>point_entree</rename>
      </field>
      <field>
        <name>Total</name>
        <rename>total</rename>
      </field>
      <field>
        <name>MRE</name>
        <rename>mre</rename>
      </field>
      <field>
        <name>Touristes_Etrangers</name>
        <rename>touristes_etrangers</rename>
      </field>
    </fields>
  </step>
  <step>
    <name>Nettoyer_numeriques</name>
    <type>ReplaceInString</type>
    <distribute>Y</distribute>
    <copies>1</copies>
    <GUI>
      <xloc>600</xloc>
      <yloc>100</yloc>
      <draw>Y</draw>
    </GUI>
    <fields>
      <field>
        <in_stream_name>total</in_stream_name>
        <replace_string> </replace_string>
        <replace_by_string/>
      </field>
      <field>
        <in_stream_name>total</in_stream_name>
        <replace_string>,</replace_string>
        <replace_by_string/>
      </field>
      <field>
        <in_stream_name>mre</in_stream_name>
        <replace_string> </replace_string>
        <replace_by_string/>
      </field>
      <field>
        <in_stream_name>mre</in_stream_name>
        <replace_string>,</replace_string>
        <replace_by_string/>
      </field>
      <field>
        <in_stream_name>touristes_etrangers</in_stream_name>
        <replace_string> </replace_string>
        <replace_by_string/>
      </field>
      <field>
        <in_stream_name>touristes_etrangers</in_stream_name>
        <replace_string>,</replace_string>
        <replace_by_string/>
      </field>
    </fields>
  </step>
  <step>
    <name>Convertir_types</name>
    <type>SelectValues</type>
    <distribute>Y</distribute>
    <copies>1</copies>
    <GUI>
      <xloc>850</xloc>
      <yloc>100</yloc>
      <draw>Y</draw>
    </GUI>
    <fields>
      <field>
        <name>total</name>
        <type>Integer</type>
        <format>########</format>
        <length>12</length>
        <precision>0</precision>
      </field>
      <field>
        <name>mre</name>
        <type>Integer</type>
        <format>########</format>
        <length>12</length>
        <precision>0</precision>
      </field>
      <field>
        <name>touristes_etrangers</name>
        <type>Integer</type>
        <format>########</format>
        <length>12</length>
        <precision>0</precision>
      </field>
      <field>
        <name>voie_acces</name>
        <type>String</type>
        <format/>
        <length>100</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>point_entree</name>
        <type>String</type>
        <format/>
        <length>100</length>
        <precision>-1</precision>
      </field>
    </fields>
  </step>
  <step>
    <name>Trim_champs</name>
    <type>StringOperations</type>
    <distribute>Y</distribute>
    <copies>1</copies>
    <GUI>
      <xloc>1100</xloc>
      <yloc>100</yloc>
      <draw>Y</draw>
    </GUI>
    <fields>
      <field>
        <name>voie_acces</name>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>point_entree</name>
        <trim_type>both</trim_type>
      </field>
    </fields>
  </step>
  <step>
    <name>Inserer_dim_voies_acces</name>
    <type>InsertUpdate</type>
    <distribute>Y</distribute>
    <copies>1</copies>
    <GUI>
      <xloc>1350</xloc>
      <yloc>100</yloc>
      <draw>Y</draw>
    </GUI>
    <connection>morocco_tourism</connection>
    <table>dim_voies_acces</table>
    <commit>1000</commit>
    <use_batch>Y</use_batch>
    <lookup>
      <key>
        <name>voie_acces</name>
        <field>voie_acces</field>
        <condition>=</condition>
      </key>
      <key>
        <name>point_entree</name>
        <field>point_entree</field>
        <condition>=</condition>
      </key>
    </lookup>
    <update>
      <update>
        <name>voie_acces</name>
        <field>voie_acces</field>
        <update>Y</update>
      </update>
      <update>
        <name>point_entree</name>
        <field>point_entree</field>
        <update>Y</update>
      </update>
    </update>
  </step>
  <step>
    <name>Lookup_voie_id</name>
    <type>DatabaseLookup</type>
    <distribute>Y</distribute>
    <copies>1</copies>
    <GUI>
      <xloc>1600</xloc>
      <yloc>100</yloc>
      <draw>Y</draw>
    </GUI>
    <connection>morocco_tourism</connection>
    <table>dim_voies_acces</table>
    <keys>
      <key>
        <condition>=</condition>
        <name>voie_acces</name>
        <field>voie_acces</field>
      </key>
      <key>
        <condition>=</condition>
        <name>point_entree</name>
        <field>point_entree</field>
      </key>
    </keys>
    <values>
      <value>
        <name>voie_id</name>
        <rename>voie_id</rename>
      </value>
    </values>
  </step>
  <step>
    <name>Inserer_fact_voies_acces</name>
    <type>InsertUpdate</type>
    <distribute>Y</distribute>
    <copies>1</copies>
    <GUI>
      <xloc>1850</xloc>
      <yloc>100</yloc>
      <draw>Y</draw>
    </GUI>
    <connection>morocco_tourism</connection>
    <table>fact_voies_acces</table>
    <commit>1000</commit>
    <use_batch>Y</use_batch>
    <lookup>
      <key>
        <name>voie_id</name>
        <field>voie_id</field>
        <condition>=</condition>
      </key>
    </lookup>
    <update>
      <update>
        <name>total_passages</name>
        <field>total</field>
        <update>Y</update>
      </update>
      <update>
        <name>mre_passages</name>
        <field>mre</field>
        <update>Y</update>
      </update>
      <update>
        <name>touristes_etrangers</name>
        <field>touristes_etrangers</field>
        <update>Y</update>
      </update>
    </update>
  </step>
  <hop>
    <from>Lire_voies_acces</from>
    <to>Standardiser_colonnes</to>
    <enabled>Y</enabled>
  </hop>
  <hop>
    <from>Standardiser_colonnes</from>
    <to>Nettoyer_numeriques</to>
    <enabled>Y</enabled>
  </hop>
  <hop>
    <from>Nettoyer_numeriques</from>
    <to>Convertir_types</to>
    <enabled>Y</enabled>
  </hop>
  <hop>
    <from>Convertir_types</from>
    <to>Trim_champs</to>
    <enabled>Y</enabled>
  </hop>
  <hop>
    <from>Trim_champs</from>
    <to>Inserer_dim_voies_acces</to>
    <enabled>Y</enabled>
  </hop>
  <hop>
    <from>Inserer_dim_voies_acces</from>
    <to>Lookup_voie_id</to>
    <enabled>Y</enabled>
  </hop>
  <hop>
    <from>Lookup_voie_id</from>
    <to>Inserer_fact_voies_acces</to>
    <enabled>Y</enabled>
  </hop>
</transformation>
